<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>SacsiN | Buyer</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
        integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="../assets/css/sacsin-admin-style.css">
    <link rel="stylesheet" href="../assets/css/sacsin-scrollbar-style.css">

    <!-- Font Awesome JS -->
    <script defer src="../assets/fontawesome-free-5.15.3-web/js/all.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <!-- Sidebar  -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <h3 hidden>SacsiN Sidebar</h3>
                <img src="../assets/img/logo/sacsin_logo_dark.png" alt="" width="100">
            </div>

            <ul class="list-unstyled components pt-3">
                <h3 class="ml-4 mb-4 text-uppercase">Buyer</h3>
                <li>
                    <a href="#">
                        <span class="mx-3"><i class="fas fa-chart-pie"></i></span> Overview
                    </a>
                </li>
                <li class="active">
                    <a href="#requestPackage" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle">
                        <span class="mx-3"><i class="fas fa-box"></i></span> Request Package
                    </a>
                    <ul class="collapse list-unstyled show" id="requestPackage">
                        <li>
                            <a href="./">Request Packages</a>
                        </li>
                        <li>
                            <a href="create-request">Create Request</a>
                        </li>
                        <li>
                            <a href="object">Request Package Template</a>
                        </li>
                        <li class="current">
                            <a href="request-sentence">Request Sentence</a>
                        </li>
                        <li>
                            <a href="expected-response">Expected Response</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#">
                        <span class="mx-3"><i class="fas fa-comments"></i></span> Settings
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Page Content  -->
        <div id="content">

            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">

                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i>
                    </button>

                    <div class="form-group has-search">
                        <span class="fa fa-search form-control-feedback"></span>
                        <input type="text" class="form-control" placeholder="Search">
                    </div>

                    <div class="profile">
                        <span class="mr-4 notification"><i class="fa fa-bell"></i></span>
                        <span class="mr-1 username">James Green</span>
                        <img src="../assets/img/pp_default.jpg" alt="pp" style="border-radius: 50%;" width="35px">
                    </div>

                </div>
            </nav>

            <div class="p-5 pt-4">

                <h2 class="mb-5">Request Sentences</h2>

                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body">
                        <h4 class="card-title">
                            Migration from material
                            <span class="card-actions">
                                <span><i class="fa fa-trash"></i></span>
                                <span><i class="fa fa-search"></i></span>
                                <span><button class="btn btn-primary-light"
                                        data-display="#migration">New</button></span>
                            </span>
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Element</th>
                                        <th scope="col">Standard for Test</th>
                                        <th scope="col">Expected Response</th>
                                        <th scope="col">Last Edited</th>
                                    </tr>
                                </thead>
                                <tbody class="migration-from-material">
                                    <!-- Inject table data dynamically here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body">
                        <h4 class="card-title">
                            Certification of production - site of production of buyer products
                            <span class="card-actions">
                                <span><i class="fa fa-trash"></i></span>
                                <span><i class="fa fa-search"></i></span>
                                <span><button class="btn btn-primary-light" data-display="#">New</button></span>
                            </span>
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Standard for Certification</th>
                                        <th scope="col">Expected Response</th>
                                        <th scope="col">Last Edited</th>
                                    </tr>
                                </thead>
                                <tbody class="certification-of-production">
                                    <!-- Inject table data dynamically here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-4">
                    <div class="card-body">
                        <h4 class="card-title">
                            Content in material
                            <span class="card-actions">
                                <span><i class="fa fa-trash"></i></span>
                                <span><i class="fa fa-search"></i></span>
                                <span><button class="btn btn-primary-light"
                                        data-display="#content-in-migration">New</button></span>
                            </span>
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Element</th>
                                        <th scope="col">Maximum Limit</th>
                                        <th scope="col">Unit</th>
                                        <th scope="col">Last Edited</th>
                                    </tr>
                                </thead>
                                <tbody class="content-in-material">
                                    <!-- Inject table data dynamically here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm border-0 mb-5">
                    <div class="card-body">
                        <h4 class="card-title">
                            Substance released
                            <span class="card-actions">
                                <span><i class="fa fa-trash"></i></span>
                                <span><i class="fa fa-search"></i></span>
                                <span>
                                    <button type="button" class="btn btn-primary-light"
                                        data-display="#subs-rel">New</button>
                                </span>
                            </span>
                        </h4>
                        <div class="table-responsive mt-5">
                            <table class="table table-hover mt-3">
                                <!-- <thead>
                                    <tr>
                                        <th scope="col">
                                            <input type="checkbox" name="">
                                        </th>
                                        <th scope="col">Substance</th>
                                        <th scope="col">Last Edited</th>
                                    </tr>
                                </thead> -->
                                <tbody class="substance-released">
                                    <!-- Inject table data dynamically here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Side Pane -->
    <div class="side-pane-backdrop" id="subs-rel">
        <div class="side-pane loading">
            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <h5 class="mt-2">Create Request Sentence</h5>
                    <div>
                        <button type="button" class="btn btn-light close-side-pane">Cancel</button>
                        <button type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </nav>
            <div class="side-pane-wrapper">
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Substance
                        </h5>
                        <!-- <hr> -->
                        <form action="#" class="my-4">
                            <select class="form-control" name="">
                                <option value="" selected disabled>Select Substance</option>
                                <option value="">Carbon dioxide</option>
                                <option value="">Carbon monoxide</option>
                            </select>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="side-pane-backdrop" id="migration">
        <div class="side-pane loading">
            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <div>
                        <h4>Create Request Sentence</h4>
                    </div>
                    <div>
                        <button type="button" class="btn btn-light close-side-pane">Cancel</button>
                        <button type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </nav>
            <div class="side-pane-wrapper">
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Migration from material
                        </h5>
                        <hr>
                        <form action="#" class="my-4">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Element</label>
                                        <select class="form-control" name="">
                                            <option value="Cadmium (48)">Cadmium (48)</option>
                                            <option value="Lead (82)">Lead (82)</option>
                                            <option value="Copper (29)">Copper (29)</option>
                                            <option value="Mercury (80)">Mercury (80)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="">Maximum Limit</label>
                                        <input class="form-control" type="number" min="1" name="">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Standard for test method</label>
                                        <select class="form-control" name="">
                                            <option value="EN 71-3:2019">EN 71-3:2019</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="">Unit of measure</label>
                                        <select class="form-control" name="">
                                            <option value="mg/kg">mg/kg</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Expected Response
                            <span class="float-right" data-display="#subs">
                                <i class="fas fa-pen text-icons"></i>
                            </span>
                        </h5>
                        <div class="text-center" id="selected-exp-resps">
                            <div class="rounded-circle mx-auto"
                                style="background: #d5d5d5; width: 125px; height: 125px; display: flex; margin-top: 4rem;">
                                <i class="fas fa-archive fa-3x m-auto text-white"></i>
                            </div>
                            <p class="text-primary pt-5 cursor-pointer" data-display="#subs">Select Expected Response
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="side-pane-backdrop" id="content-in-migration">
        <div class="side-pane loading">
            <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <div>
                        <h4>Create Request Sentence</h4>
                    </div>
                    <div>
                        <button type="button" class="btn btn-light close-side-pane">Cancel</button>
                        <button type="button" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </nav>
            <div class="side-pane-wrapper">
                <div class="card shadow-sm border-0 m-5">
                    <div class="card-body">
                        <h5 class="card-title">
                            Content in material
                        </h5>
                        <hr>
                        <form action="#" class="mt-4">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="mb-4">
                                        <label for="">Element</label>
                                        <select class="form-control" name="">
                                            <option value="" selected disabled>Select Element</option>
                                            <option value="">Sodium</option>
                                            <option value="">Carbon</option>
                                            <option value="">Chlorine</option>
                                            <option value="">Cobalt</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Maximum limit</label>
                                        <select class="form-control" name="">
                                            <option value="" selected disabled>Select Maximum Limit</option>
                                            <option value="">Limit 0</option>
                                            <option value="">Limit 1</option>
                                            <option value="">Limit 2</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-4">
                                        <label for="">Unit of measure</label>
                                        <select class="form-control" name="">
                                            <option value="" selected disabled>Select Unit of Measure</option>
                                            <option value="">Kilograms</option>
                                            <option value="">Square meters</option>
                                            <option value="">Cubic meters</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sub Side Pane -->
    <div class="side-select-pane-backdrop" id="subs">
        <div class="side-select-pane loading">
            <nav class="navbar bg-light no-shadow">
                <div class="container-fluid">
                    <h5 class="mt-2">
                        <span class="close-sub-side-pane mr-3">
                            <i class="fas fa-times"></i>
                        </span>
                        Select Expected Response
                    </h5>
                    <div>
                        <span>
                            <i class="fas fa-search"></i>
                        </span>
                    </div>
                </div>
            </nav>
            <div class="side-select-pane-wrapper">
                <form>
                    <div class="text-left ml-5 mb-3">
                        <button type="button" class="btn btn-primary" id="select-exp-resp">Select</button>
                    </div>
                    <div class="scrollable responses">
                        <div class="row ml-0">
                            <div class="col-sm-1">
                                <input type="checkbox">
                            </div>
                            <div class="col-sm-9">
                                <span class="option-txt">Response Name 1</span>
                                <br>
                                <span class="text-details">
                                    EN:123456, Doc ID, Doc Issuer, Result
                                </span>
                            </div>
                        </div>
                        <div class="row ml-0">
                            <div class="col-sm-1">
                                <input type="checkbox">
                            </div>
                            <div class="col-sm-9">
                                <span class="option-txt">Response Name 2</span>
                                <br>
                                <span class="text-details">
                                    EN:123456, Doc ID, Result
                                </span>
                            </div>
                        </div>
                        <div class="row ml-0">
                            <div class="col-sm-1">
                                <input type="checkbox">
                            </div>
                            <div class="col-sm-9">
                                <span class="option-txt">Response Name 3</span>
                                <br>
                                <span class="text-details">
                                    EN:123456, Doc ID, Expiry Date
                                </span>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <!-- Popper.JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
        integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous">
    </script>
    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"
        integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous">
    </script>
    <!-- Moment JS -->
    <script src="../assets/plugins/js/moment.min.js"></script>
    <!-- Custom Script -->
    <script src="../assets/js/sacsin-admin-script.js"></script>

    <script>
        $(document).ready(function ($) {

            // Select Object
            $(".scrollable.responses").contents().find(":checkbox").bind("change", function () {
                val = this.checked, $(this).parent().parent().toggleClass("checked");
                let selected_exp_resps = []
                $('.responses .checked .option-txt').each((i, elm) => {
                    selected_exp_resps.push(elm.innerHTML)
                })
                console.log(selected_exp_resps)
                $('#select-exp-resp').on('click', () => {
                    $('#selected-exp-resps').empty()
                    selected_exp_resps.forEach((exp_resp) => {
                        $('#selected-exp-resps').append(
                            `<div class="border rounded my-3 p-3">${exp_resp}</div>`
                        )
                    })
                })
            })


            //
            fetchMigrationFromMaterial() // fetch certification of production
            fetchCertificationOfProduction() // fetch certification of production
            fetchContentInMaterial() // fetch content in material
            fetchSubstanceReleased() // fetch substance released
            

            function fetchSubstanceReleased() {
                $.ajax({
                    dataType: 'json',
                    type: 'POST',
                    data: jQuery.param({table: "substance_released"}),
                    url: '../assets/php/ReadRequestSentences.php',
                    success: (res_data) => {
                        console.log(res_data)
                        let table_rows = ""
                        res_data.forEach(data => {
                            table_rows += `
                            <tr>
                                <th scope="row">
                                    <input type="checkbox" name="">
                                </th>
                                <td class="text-primary">${data.release_type}</td>
                                <td>${data.release_substance}</td>
                            </tr>`
                        })
                        // Inject data to table
                        $('tbody.substance-released').html(table_rows)
                    }
                })
            }

            function fetchContentInMaterial() {
                $.ajax({
                    dataType: 'json',
                    type: 'POST',
                    data: jQuery.param({table: "content_in_material"}),
                    url: '../assets/php/ReadRequestSentences.php',
                    success: (res_data) => {
                        console.log(res_data)
                        let table_rows = ""
                        res_data.forEach(data => {
                            // let last_edited = (data.updated_at.split(' ')[0]).split('-').reverse().join('/')
                            // let last_edited = moment(data.updated_at, "YYYY-MM-DD hh:mm:ss").fromNow()
                            table_rows += `
                            <tr>
                                <th scope="row">
                                    <input type="checkbox" name="">
                                </th>
                                <td class="text-primary">${data.element}</td>
                                <td>${data.maximum_limit}</td>
                                <td>${data.measurement_unit}</td>
                                <td>${getLastEdited(data.updated_at)}</td>
                            </tr>`
                        })
                        // Inject data to table
                        $('tbody.content-in-material').html(table_rows)
                    }
                })
            }

            function fetchCertificationOfProduction() {
                $.ajax({
                    dataType: 'json',
                    type: 'POST',
                    data: jQuery.param({table: "certification_of_production"}),
                    url: '../assets/php/ReadRequestSentences.php',
                    success: (res_data) => {
                        console.log(res_data)
                        let table_rows = ""
                        res_data.forEach(data => {
                            table_rows += `
                            <tr>
                                <th scope="row">
                                    <input type="checkbox" name="">
                                </th>
                                <td>${data.certification_standard}</td>
                                <td>
                                    <button class="alert alert-info" role="alert" style="border-radius: 25px;">
                                        ${data.expected_response}
                                    </button>
                                </td>
                                <td>${getLastEdited(data.updated_at)}</td>
                            </tr>`
                        })
                        // Inject data to table
                        $('tbody.certification-of-production').html(table_rows)
                    }
                })
            }

            function fetchMigrationFromMaterial() {
                $.ajax({
                    dataType: 'json',
                    type: 'POST',
                    data: jQuery.param({table: "migration_from_material"}),
                    url: '../assets/php/ReadRequestSentences.php',
                    success: (res_data) => {
                        console.log(res_data)
                        let table_rows = ""
                        res_data.forEach(data => {
                            table_rows += `
                            <tr>
                                <th scope="row">
                                    <input type="checkbox" name="">
                                </th>
                                <td class="text-primary">${data.element}</td>
                                <td>${data.test_standard}</td>
                                <td>
                                    <button class="alert alert-success" role="alert"
                                        style="border-radius: 25px;">
                                        ${data.expected_response}
                                    </button>
                                </td>
                                <td>${getLastEdited(data.updated_at)}</td>
                            </tr>`
                        })
                        // Inject data to table
                        $('tbody.migration-from-material').html(table_rows)
                    }
                })
            }

            /**
             * Get last edited.
             * @param {string} _time - The time at which object was updated.
             * @return {string}
            */
            function getLastEdited(_time) {
                return moment(_time, "YYYY-MM-DD hh:mm:ss").fromNow()
            }

        })
    </script>

</body>

</html>