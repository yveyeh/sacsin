<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <title>SacsiN | Login</title>
    <!-- Favicon-->
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <!-- Bootstrap Icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <!-- Core CSS [includes Bootstrap]-->
    <link href="assets/css/sacsin-style.css" rel="stylesheet" />
    <link href="assets/css/sacsin-loader-style.css" rel="stylesheet" />
    <link href="assets/css/sacsin-scrollbar-style.css" rel="stylesheet" />
</head>

<body>
    <!-- Navigation-->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top py-3 navbar-shrink" id="mainNav">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand" href="./">
                <img src="assets/img/logo/sacsin_logo_dark.png" alt="SacsiN" width="100">
            </a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav mx-auto my-2 my-lg-0">
                    <li class="nav-item"><a class="nav-link" href="./"><i class="bi-house-fill"></i></a></li>
                    <li class="nav-item"><a class="nav-link" href="./about-us">About SacsiN</a></li>
                    <li class="nav-item"><a class="nav-link" href="./todays-challenge">The Challenge</a></li>
                    <li class="nav-item"><a class="nav-link" href="./the-sacsin-project">SacsiN Demo</a></li>
                    <li class="nav-item"><a class="nav-link" href="./events">Events</a></li>
                    <li class="nav-item"><a class="nav-link" href="./faq">FAQ</a></li>
                    <li class="nav-item"><a class="nav-link" href="./contact-us">Contact Us</a></li>
                </ul>
                <div class="nav-extra-icons">
                    <i class="bi-search" style="display: none;"></i>
                    <i class="bi-person-circle text-warning" onclick="location.href='./login.html'"></i>
                </div>
            </div>
        </div>
    </nav>
    <!-- Login -->
    <section class="page-section bg-light mt-5">
        <div class="container px-4 px-lg-5">
            <div class="row justify-content-center">
                <div class="col-md-8 col-lg-8">
                    <div class="wrap d-md-flex">
                        <div class="img" style="background-image: url('assets/img/bg_login_form.jpg');"></div>
                        <div class="login-wrap p-4 p-md-5">
                            <div class="d-flex">
                                <div>
                                    <h3 class="mb-2">Login</h3>
                                    <p class="text-secondary mb-0">
                                        To create an account please
                                        <a class="text-warning" href="./contact-us">contact us.</a>
                                    </p>
                                </div>
                            </div>
                            <form action="#" class="login-form">
                                <div class="form-group my-4">
                                    <label class="label" for="name">Email Address</label>
                                    <input type="email" class="form-control" placeholder="Enter Email Address" required>
                                </div>
                                <div class="form-group mt-4 mb-1">
                                    <p class="label mb-0" for="password">
                                        Password
                                        <!-- <span class="pull-end"><a href="#">Forgot Password?</a></span> -->
                                    </p>
                                    <input type="password" class="form-control" placeholder="Enter Password"
                                        autocomplete="on" required>
                                </div>
                                <div class="form-group d-md-flex">
                                    <div class="w-50 text-left">
                                        <label class="checkbox-primary mb-0">
                                            <input type="checkbox" checked="">
                                            <span class="checkmark" style="font-size: small;">Remember me</span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-group mt-4">
                                    <select class="form-control" name="role" required>
                                        <option value="" disabled selected hidden class="text-light">Select a role
                                        </option>
                                        <option value="buyer">Buyer</option>
                                        <option value="seller">Seller</option>
                                    </select>
                                </div>
                                <!-- loader -->
                                <div class="loader-bars m-auto mt-3"></div>
                                <!-- login feedback -->
                                <p class="alert text-center mt-2" id="login-feedback"></p>
                                <div class="form-group mt-4">
                                    <button type="button" class="form-control btn btn-warning rounded submit px-3">
                                        Login
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Footer-->
    <footer class="bg-dark py-5">
        <div class="container my-3">
            <div class="row gx-4 gx-lg-5">
                <div class="col-lg-6 col-md-6">
                    <div id="footer-logo" class="mb-4">
                        <img src="assets/img/logo/sacsin_logo_light.png" alt="SacsiN" width="100">
                    </div>
                    <div id="footer-description">
                        <p class="text-white">
                            Your way of exchanging industry independent Sustainability and Compliance Information within
                            all tiers of your supply chain.
                        </p>
                    </div>
                    <div class="social-auth">
                        <a href="javascript:void(0)" class="btn btn-google"></a>
                        <a href="javascript:void(0)" class="btn btn-facebook"></a>
                        <a href="javascript:void(0)" class="btn btn-twitter"></a>
                        <a href="javascript:void(0)" class="btn btn-instagram"></a>
                        <a href="javascript:void(0)" class="btn btn-linkedin"></a>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 mt-5">
                    <div id="footer-menu">
                        <ul>
                            <li><a href="./" class="text-light">Home</a></li>
                            <li><a href="./about-us" class="text-light">About Us</a></li>
                            <li><a href="./todays-challenge" class="text-light">The Challenge</a></li>
                            <li><a href="./the-sacsin-project" class="text-light">SacsiN Demo</a></li>
                            <li><a href="./events" class="text-light"> Events</a></li>
                            <li><a href="./faq" class="text-light">FAQ</a></li>
                            <li><a href="./contact-us" class="text-light">Contact Us</a></li>
                        </ul>
                    </div>
                    <div id="copyright" class="text-secondary">
                        <script>
                            document.write(`&copy; ${new Date().getFullYear()}, Design By HOP`)
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Bootstrap core JS-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
    <!-- <script src="assets/js/sacsin-script.js"></script> -->

    <!-- jQuery CDN -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
        $(document).ready(function ($) {
            // Inject copyright markup
            $('#copyright').html(`&copy; ${new Date().getFullYear()}, Design By HOP`)

            // submit the login form on button click
            $('.login-form .submit').on('click', () => {
                let data = {
                    email: $('.login-form [type="email"]').val(),
                    pass: $('.login-form [type="password"]').val(),
                    role: $('.login-form [name="role"]').val(),
                }
                // console.log(data)
                data.role != null ? login(data) : $('.login-form [name="role"]').css({
                    "color": "red",
                    "border-color": "red"
                })
                $('.login-form [name="role"]').change(() => {
                    $('.login-form [name="role"]').css({
                        "color": "#212529",
                        "border-color": "#ced4da"
                    })
                })
            })

            /** */
            function login(data) {
                $.ajax({
                    data: data,
                    dataType: 'json',
                    method: 'POST',
                    url: './assets/php/Login.php',
                    success: (res_data) => {
                        console.log(res_data)
                        if (res_data[0]) {
                            showLoader(2000)
                            setTimeout(() => {
                                showLoginFeedback('success', 'Login successful.', 1500)
                                redirect(1500,
                            () => { // redirect to the respective home page "dashboards"
                                    res_data[0].role === 'buyer' ? location.href =
                                        './buyer/' : location.href = './seller/'
                                })
                            }, 2000)
                        } else {
                            showLoader(2000)
                            setTimeout(() => {
                                showLoginFeedback('danger', res_data.error, 1500)
                            }, 2000)
                        }
                    },
                    error: (res) => {
                        showLoader(2000)
                        setTimeout(() => {
                            showLoginFeedback('danger',
                                'Sorry! an error was encountered during login!', 3000)
                        }, 2000)
                    }
                })
            }

            /**
             * Show login feedback.
             * @param {string} type - The type of login feedback: (`danger`, `success`).
             * @param {string} message - The feedback message to display.
             * @param {number} duration - The length of time before fading out.
             * @return void
             */
            function showLoginFeedback(type, message, duration) {
                $('#login-feedback').addClass(`alert-${type}`)
                $('#login-feedback').html(message)
                $('#login-feedback').fadeIn('slow', () => {
                    setTimeout(() => {
                        $('#login-feedback').fadeOut('slow', () => {
                            $('#login-feedback').removeClass(`alert-${type}`)
                        })
                    }, duration)
                })
            }

            /**
             * Redirects to a specified path withing the callback function.
             * @param {number} wait - The type of login feedback: (`danger`, `success`).
             * @param {function} callback - The feedback message to display.
             * @return void
             */
            function redirect(wait, callback = () => {}) {
                setTimeout(
                    callback, // call the handler that is passed as parameter
                    wait) // wait for given length of time
            }

            /**
             * Shows the loader.
             * @param {number} duration - The length of time to display.
             * @return void
             */
            function showLoader(duration) {
                $('.loader-bars').css('display', 'block')
                setTimeout(() => {
                    $('.loader-bars').css('display', 'none')
                }, duration)
            }

        })
    </script>

</body>

</html>